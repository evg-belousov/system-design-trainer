import type { Question } from '../types';

export const securityQuestions: Question[] = [
  {
    id: 'sa-security-001',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какой из процессов отвечает за проверку подлинности пользователя (подтверждение, что пользователь — тот, за кого себя выдаёт)?',
    options: [
      'Идентификация',
      'Аутентификация',
      'Авторизация',
      'Аудит',
    ],
    correctIndex: 1,
    explanation:
      'Аутентификация — это процесс проверки подлинности субъекта, то есть подтверждения, что пользователь является тем, за кого себя выдаёт. Обычно осуществляется через ввод пароля, предъявление сертификата, биометрию или одноразовый код. Идентификация — предшествующий этап, на котором пользователь заявляет о своей личности (вводит логин, email). Авторизация — следующий этап, определяющий, какие действия и ресурсы доступны уже аутентифицированному пользователю. Аудит — запись действий пользователя для последующего анализа. Последовательность: идентификация -> аутентификация -> авторизация -> аудит.',
  },
  {
    id: 'sa-security-002',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'В чём принципиальное различие между шифрованием и хэшированием?',
    options: [
      'Шифрование быстрее хэширования',
      'Шифрование обратимо (данные можно восстановить), хэширование — необратимо (одностороннее преобразование)',
      'Хэширование используется только для файлов, шифрование — только для текста',
      'Хэширование всегда требует ключ, а шифрование — нет',
    ],
    correctIndex: 1,
    explanation:
      'Фундаментальное различие: шифрование — обратимая операция. Имея ключ (в симметричном шифровании — один ключ; в асимметричном — пару ключей), можно восстановить исходные данные. Используется для защиты данных при передаче и хранении (TLS, AES, RSA). Хэширование — необратимая (одностороннее) операция: из хэша невозможно восстановить исходные данные. Одинаковый вход всегда даёт одинаковый хэш (детерминированность). Используется для хранения паролей (bcrypt, Argon2), проверки целостности данных (SHA-256), цифровых подписей. Для паролей всегда используется хэширование (не шифрование!), потому что системе не нужно знать исходный пароль — достаточно сравнить хэши.',
  },
  {
    id: 'sa-security-003',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой стандартный протокол позволяет пользователю авторизовать сторонне приложение на доступ к своим данным без передачи логина и пароля этому приложению?',
    options: [
      'LDAP',
      'OAuth 2.0',
      'Kerberos',
      'SAML',
    ],
    correctIndex: 1,
    explanation:
      'OAuth 2.0 — протокол авторизации, который позволяет пользователю предоставить стороннему приложению ограниченный доступ к своим ресурсам (например, профилю, контактам) без раскрытия своих учётных данных. Приложение получает access token с определённым scope (набором разрешений). Пример: «Войти через Google» — пользователь авторизует приложение на чтение своего профиля Google, не передавая ему пароль от Google-аккаунта. LDAP — протокол доступа к каталогу (хранилищу пользователей), часто используется для аутентификации в корпоративной среде. Kerberos — протокол аутентификации на основе тикетов, широко используется в Active Directory. SAML — стандарт для обмена данными аутентификации/авторизации между identity provider и service provider (SSO в корпоративной среде).',
  },
  {
    id: 'sa-security-004',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Объясните разницу между симметричным и асимметричным шифрованием. Приведите примеры использования каждого типа в реальных системах.',
    sampleAnswer:
      'Симметричное шифрование использует один и тот же ключ для шифрования и дешифрования. Преимущество — высокая скорость, недостаток — необходимость безопасной передачи ключа обеим сторонам. Алгоритмы: AES (128/256 бит), ChaCha20. Применение: шифрование данных в базе, шифрование файлов, шифрование трафика внутри установленного TLS-соединения. Асимметричное шифрование использует пару ключей: открытый (public) для шифрования и закрытый (private) для дешифрования. Преимущество — не нужно передавать секретный ключ; недостаток — значительно медленнее симметричного. Алгоритмы: RSA, ECDSA, Ed25519. Применение: цифровые подписи, обмен ключами (key exchange) при установке TLS-соединения, SSH-аутентификация, PKI-сертификаты. На практике часто используется гибридный подход (TLS): асимметричное шифрование для безопасного обмена сессионным ключом, а затем симметричное шифрование для передачи данных — это сочетает безопасность асимметричной схемы со скоростью симметричной.',
    explanation:
      'Гибридный подход (асимметричное + симметричное) — стандарт в современных протоколах. TLS-рукопожатие (handshake): клиент и сервер при помощи асимметричного шифрования (или Diffie-Hellman) согласовывают симметричный сессионный ключ, которым затем шифруется весь трафик. Аналитик должен понимать эти основы для грамотного формулирования требований к защите данных при передаче и хранении.',
  },
  {
    id: 'sa-security-005',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Вы проектируете систему аутентификации и авторизации для микросервисной архитектуры с мобильным и веб-клиентами. Опишите архитектуру решения, выбор протоколов и механизмы обеспечения безопасности межсервисного взаимодействия.',
    sampleAnswer:
      'Архитектура: (1) Выделенный Identity Provider (IdP) — централизованный сервис аутентификации (Keycloak, Auth0 или собственная реализация). Хранит учётные записи, поддерживает MFA. (2) Протокол: OAuth 2.0 + OpenID Connect (OIDC). OAuth 2.0 — для авторизации (выдача access tokens), OIDC — надстройка для аутентификации (ID token с информацией о пользователе). (3) Потоки: для веб-приложения — Authorization Code Flow с PKCE (защита от перехвата authorization code); для мобильного — тот же Authorization Code Flow с PKCE (implicit flow устарел). (4) Токены: access token (JWT, короткоживущий, 5-15 мин) содержит claims: user_id, roles, scopes, exp; refresh token (длинноживущий, httpOnly cookie) для обновления access token без повторного ввода пароля. (5) API Gateway как точка валидации токенов: проверяет подпись JWT, срок действия, scope. Далее передаёт claims в заголовках внутренним сервисам. (6) Межсервисная авторизация: service-to-service — через client credentials grant (OAuth 2.0) или mTLS (mutual TLS). Каждый сервис имеет свой идентификатор и набор разрешений. (7) Безопасность: хранение паролей — bcrypt/Argon2; токены подписываются RS256 (асимметрично, чтобы сервисы могли верифицировать не имея приватного ключа); CORS-политики для веб-клиента; rate limiting на эндпоинтах аутентификации; защита от CSRF (SameSite cookies + CSRF-токены).',
    explanation:
      'Ключевые принципы: (1) Централизация аутентификации в IdP — единый источник правды. (2) Stateless-авторизация через JWT — не нужно обращаться к IdP при каждом запросе. (3) Принцип наименьших привилегий — минимальные scopes для каждого клиента и сервиса. (4) Defence in depth — валидация на уровне Gateway + повторная проверка в сервисах. (5) Zero Trust — не доверять внутренней сети, использовать mTLS между сервисами. Аналитик должен специфицировать матрицу ролей и разрешений, потоки аутентификации для каждого типа клиента и требования к безопасности хранения токенов.',
  },
  {
    id: 'sa-security-006',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой OAuth 2.0 flow рекомендуется для публичных клиентов (SPA, мобильные приложения) согласно современным рекомендациям безопасности?',
    options: [
      'Implicit Flow',
      'Resource Owner Password Credentials',
      'Authorization Code Flow с PKCE',
      'Client Credentials Flow',
    ],
    correctIndex: 2,
    explanation:
      'Authorization Code Flow с PKCE (Proof Key for Code Exchange) рекомендуется для всех публичных клиентов (SPA, мобильные и десктопные приложения). PKCE защищает от перехвата authorization code: клиент генерирует случайный code_verifier и отправляет его хэш (code_challenge) при запросе авторизации, а затем передаёт сам code_verifier при обмене кода на токен. Implicit Flow (токен возвращается прямо в URL-фрагменте) считается устаревшим из-за рисков утечки токена через историю браузера, referer-заголовки и логи. Resource Owner Password Credentials передаёт пароль напрямую через клиентское приложение — не рекомендуется. Client Credentials — для межсервисного (machine-to-machine) взаимодействия без участия пользователя.',
  },
  {
    id: 'sa-security-007',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что из перечисленного является примером многофакторной аутентификации (MFA)?',
    options: [
      'Ввод логина и пароля',
      'Ввод пароля и одноразового кода из SMS',
      'Ввод логина, пароля и секретного вопроса',
      'Использование двух разных паролей',
    ],
    correctIndex: 1,
    explanation:
      'Многофакторная аутентификация (MFA) требует предъявления двух или более факторов разных типов: (1) фактор знания — то, что пользователь знает (пароль, PIN, ответ на секретный вопрос); (2) фактор владения — то, что пользователь имеет (телефон для SMS/TOTP, аппаратный токен, смарт-карта); (3) фактор свойства — то, чем пользователь является (биометрия: отпечаток, лицо, голос). Ввод пароля + одноразовый код из SMS — это два разных фактора (знание + владение). Логин + пароль — один фактор (знание; логин — это идентификация, не аутентификация). Пароль + секретный вопрос — два экземпляра одного фактора (знание + знание), что не является полноценной MFA. Два пароля — аналогично, один фактор.',
  },
  {
    id: 'sa-security-008',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какая уязвимость из списка OWASP Top 10 связана с внедрением вредоносного кода в SQL-запросы через пользовательский ввод?',
    options: [
      'Cross-Site Scripting (XSS)',
      'SQL Injection',
      'Broken Access Control',
      'Security Misconfiguration',
    ],
    correctIndex: 1,
    explanation:
      'SQL Injection — уязвимость, при которой злоумышленник внедряет вредоносный SQL-код через пользовательский ввод (формы, URL-параметры), если приложение формирует SQL-запросы путём конкатенации строк без экранирования. Пример: ввод " OR 1=1 --" в поле логина может обойти аутентификацию. Защита: использование параметризованных запросов (prepared statements), ORM-фреймворков, валидация и санитизация ввода, принцип наименьших привилегий для учётной записи БД. SQL Injection входит в категорию «Injection» OWASP Top 10. XSS — внедрение скриптов в веб-страницу. Broken Access Control — ошибки в проверке прав доступа. Security Misconfiguration — небезопасная конфигурация.',
  },
  {
    id: 'sa-security-009',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое PKI (Public Key Infrastructure)?',
    options: [
      'Протокол передачи данных между клиентом и сервером',
      'Инфраструктура управления открытыми ключами, включающая удостоверяющие центры (CA), сертификаты и механизмы их проверки',
      'Фреймворк для автоматического тестирования безопасности',
      'Стандарт шифрования для баз данных',
    ],
    correctIndex: 1,
    explanation:
      'PKI (Public Key Infrastructure) — инфраструктура, обеспечивающая создание, распространение, управление и отзыв цифровых сертификатов. Основные компоненты: (1) CA (Certificate Authority) — удостоверяющий центр, выпускающий и подписывающий сертификаты (Let\'s Encrypt, DigiCert). (2) RA (Registration Authority) — проверяет идентичность запрашивающего сертификат. (3) Цифровые сертификаты (X.509) — связывают публичный ключ с идентичностью владельца. (4) CRL/OCSP — механизмы проверки отзыва сертификатов. PKI лежит в основе HTTPS/TLS: браузер проверяет сертификат сервера по цепочке доверия до корневого CA, что гарантирует подлинность сервера и шифрование трафика.',
  },
  {
    id: 'sa-security-010',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какая атака заключается во внедрении вредоносного JavaScript-кода в веб-страницу, которая затем выполняется в браузере других пользователей?',
    options: [
      'SQL Injection',
      'Cross-Site Request Forgery (CSRF)',
      'Cross-Site Scripting (XSS)',
      'Man-in-the-Middle (MITM)',
    ],
    correctIndex: 2,
    explanation:
      'Cross-Site Scripting (XSS) — атака, при которой злоумышленник внедряет вредоносный JavaScript-код в веб-страницу, и этот код исполняется в браузере жертвы. Типы XSS: (1) Reflected — вредоносный скрипт передаётся через URL-параметр и отражается в ответе сервера. (2) Stored — скрипт сохраняется на сервере (в БД, комментариях) и выполняется при каждом просмотре страницы. (3) DOM-based — манипуляция DOM на стороне клиента. Последствия: кража cookies/сессий, перенаправление на фишинговые сайты, выполнение действий от имени пользователя. Защита: экранирование вывода (output encoding), Content Security Policy (CSP), HttpOnly cookies, валидация ввода. CSRF — принуждение браузера жертвы к нежелательному запросу. MITM — перехват трафика.',
  },
  {
    id: 'sa-security-011',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'open',
    question: 'Что такое OWASP Top 10? Перечислите и кратко опишите хотя бы пять основных категорий уязвимостей.',
    sampleAnswer:
      'OWASP Top 10 — регулярно обновляемый список десяти наиболее критичных категорий уязвимостей веб-приложений, публикуемый организацией OWASP (Open Web Application Security Project). Основные категории (версия 2021): (1) Broken Access Control — ошибки контроля доступа: пользователи могут выполнять действия или просматривать данные, на которые у них нет прав (IDOR, обход авторизации). (2) Cryptographic Failures — ошибки в применении криптографии: передача данных без шифрования, использование устаревших алгоритмов, хранение паролей в открытом виде. (3) Injection — внедрение вредоносного кода (SQL Injection, XSS, OS Command Injection). (4) Insecure Design — небезопасная архитектура: отсутствие моделирования угроз, недостаточные проверки на уровне проектирования. (5) Security Misconfiguration — небезопасные настройки: открытые порты, дефолтные пароли, лишние права, включённые debug-режимы в продакшне. (6) Server-Side Request Forgery (SSRF) — сервер выполняет HTTP-запросы по URL, предоставленному пользователем, открывая доступ к внутренним ресурсам.',
    explanation:
      'OWASP Top 10 — отраслевой стандарт, который используется как чек-лист при проектировании и аудите безопасности. Аналитик должен знать эти уязвимости, чтобы формулировать требования к безопасности и участвовать в threat modeling. Каждая категория содержит рекомендации по предотвращению (prevention) и примеры сценариев атак.',
  },
  {
    id: 'sa-security-012',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое data masking (маскирование данных) и в каких случаях оно применяется?',
    options: [
      'Шифрование данных при передаче по сети',
      'Замена реальных чувствительных данных на фиктивные или частично скрытые значения для использования в непроизводственных средах',
      'Удаление всех персональных данных из базы данных',
      'Сжатие данных для экономии дискового пространства',
    ],
    correctIndex: 1,
    explanation:
      'Data masking (маскирование данных) — замена реальных чувствительных данных (ФИО, номера карт, email, телефоны) на фиктивные или частично скрытые значения, сохраняющие формат и реалистичность. Примеры: номер карты 4111-1111-1111-1234 → 4111-XXXX-XXXX-1234, ФИО «Иванов Иван» → «Петров Сергей». Применение: (1) тестовые среды — разработчики и тестировщики работают с реалистичными, но не настоящими данными; (2) аналитика — предоставление данных аналитикам без раскрытия персональной информации; (3) соответствие регуляторным требованиям (GDPR, PCI DSS, 152-ФЗ). Типы: статическое маскирование (создание отдельной замаскированной копии), динамическое маскирование (данные маскируются на лету при запросе в зависимости от роли пользователя).',
  },
  {
    id: 'sa-security-013',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой принцип лежит в основе архитектуры Zero Trust?',
    options: [
      'Все устройства внутри корпоративной сети считаются доверенными по умолчанию',
      'Никому и ничему не доверять по умолчанию — каждый запрос должен быть аутентифицирован и авторизован независимо от расположения в сети',
      'Безопасность обеспечивается исключительно через VPN и файрвол',
      'Все данные должны шифроваться только при хранении, но не при передаче',
    ],
    correctIndex: 1,
    explanation:
      'Zero Trust (нулевое доверие) — модель безопасности, основанная на принципе «никогда не доверяй, всегда проверяй» (never trust, always verify). В отличие от традиционного периметрового подхода (всё внутри сети — доверенное), Zero Trust предполагает: (1) каждый запрос аутентифицируется и авторизуется независимо от расположения источника (внутренняя сеть не является гарантией доверия); (2) принцип наименьших привилегий — минимально необходимый доступ; (3) микросегментация — сеть разделена на мелкие зоны с контролем доступа; (4) непрерывная верификация — проверка не только при входе, но при каждом запросе к ресурсу; (5) шифрование трафика внутри сети (mTLS). Zero Trust стал особенно актуален с распространением облаков и удалённой работы, когда понятие «периметра» размывается.',
  },
  {
    id: 'sa-security-014',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Объясните разницу между security audit (аудит безопасности) и penetration testing (тестирование на проникновение). Когда применяется каждый подход?',
    sampleAnswer:
      'Security audit (аудит безопасности) — систематическая оценка соответствия системы установленным стандартам, политикам и лучшим практикам безопасности. Аудит проверяет: конфигурации серверов и сетевого оборудования, политики доступа, процедуры управления уязвимостями, соответствие стандартам (PCI DSS, ISO 27001, GDPR). Аудит носит более формальный и всесторонний характер, может быть внутренним или внешним, обязательным (для сертификации) или добровольным. Penetration testing (пентест) — моделирование реальной атаки на систему для выявления эксплуатируемых уязвимостей. Пентестер пытается проникнуть в систему, используя те же техники, что и злоумышленник: сканирование портов, поиск уязвимостей, эксплуатация найденных слабостей, эскалация привилегий. Виды: Black Box (пентестер ничего не знает о системе), White Box (полный доступ к коду и документации), Gray Box (частичная информация). Аудит отвечает на вопрос «соответствует ли система стандартам», пентест — на вопрос «можно ли взломать систему». Оба подхода дополняют друг друга и должны проводиться регулярно.',
    explanation:
      'Аудит и пентест — два столпа проверки безопасности. Аудит выявляет организационные и процессные пробелы. Пентест выявляет технические уязвимости, которые можно реально эксплуатировать. Аналитик участвует в определении scope аудита и пентеста, подготовке документации и анализе результатов.',
  },
  {
    id: 'sa-security-015',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой стандарт устанавливает требования к безопасности обработки данных платёжных карт?',
    options: [
      'GDPR',
      'ISO 27001',
      'PCI DSS',
      'SOC 2',
    ],
    correctIndex: 2,
    explanation:
      'PCI DSS (Payment Card Industry Data Security Standard) — стандарт безопасности, разработанный Советом PCI (объединяющим Visa, Mastercard, American Express и др.) для организаций, обрабатывающих, хранящих или передающих данные платёжных карт. PCI DSS включает 12 основных требований: установка файрволов, защита хранимых данных карт, шифрование при передаче, антивирусная защита, управление доступом, мониторинг и тестирование, политика безопасности. Несоблюдение PCI DSS грозит штрафами и запретом на обработку карт. GDPR — регулирование защиты персональных данных в ЕС. ISO 27001 — стандарт управления информационной безопасностью (ISMS). SOC 2 — стандарт контроля безопасности для сервис-провайдеров.',
  },
  {
    id: 'sa-security-016',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой механизм обеспечивает взаимную аутентификацию клиента и сервера с помощью TLS-сертификатов?',
    options: [
      'OAuth 2.0 Client Credentials',
      'Mutual TLS (mTLS)',
      'API Key Authentication',
      'Basic Authentication',
    ],
    correctIndex: 1,
    explanation:
      'Mutual TLS (mTLS) — режим TLS-соединения, при котором не только сервер предъявляет сертификат клиенту (стандартный TLS), но и клиент предъявляет свой сертификат серверу. Это обеспечивает взаимную аутентификацию: обе стороны убеждены в подлинности друг друга. Применение: межсервисное взаимодействие в микросервисной архитектуре (Service Mesh / Istio), банковские API, IoT-устройства, Zero Trust архитектура. Преимущества: криптографически стойкая аутентификация, не передаются пароли/токены. Сложности: управление сертификатами (выпуск, ротация, отзыв), необходимость PKI-инфраструктуры. OAuth Client Credentials использует client_id/secret. API Key — статический ключ. Basic Auth — логин/пароль в заголовке.',
  },
  {
    id: 'sa-security-017',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Опишите основные требования GDPR (General Data Protection Regulation) с точки зрения проектирования информационных систем. Какие архитектурные решения должен предусмотреть аналитик?',
    sampleAnswer:
      'GDPR (General Data Protection Regulation) — регламент ЕС о защите персональных данных, вступивший в силу в 2018 году. Основные требования и архитектурные решения: (1) Privacy by Design — защита данных должна быть заложена в архитектуру, а не добавлена постфактум. Аналитик должен предусмотреть минимизацию данных (собирать только необходимое), разделение PII (Personally Identifiable Information) от бизнес-данных, шифрование и псевдонимизацию. (2) Право на удаление (Right to Erasure) — система должна поддерживать полное удаление персональных данных по запросу пользователя. Архитектурно: выделение PII в отдельные хранилища или поля для возможности точечного удаления, мягкое удаление с последующей жёсткой очисткой, каскадное удаление связанных данных. (3) Право на переносимость (Data Portability) — пользователь может запросить экспорт своих данных в машиночитаемом формате (JSON, CSV). (4) Согласие (Consent) — система должна получать явное согласие, хранить его историю, позволять отзыв. (5) Уведомление об утечке — автоматический мониторинг и оповещение в течение 72 часов. (6) Реестр обработок — документация всех процессов обработки персональных данных. (7) DPO (Data Protection Officer) — назначение ответственного лица.',
    explanation:
      'GDPR влияет на архитектуру на всех уровнях: модель данных (разделение PII), API (эндпоинты для прав субъекта), хранение (шифрование, retention policies), логирование (не логировать PII), интеграции (DPA — Data Processing Agreements с третьими сторонами). Аналитик должен участвовать в DPIA (Data Protection Impact Assessment) и формулировать требования к реализации каждого права субъекта данных.',
  },
  {
    id: 'sa-security-018',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой подход к управлению сертификатами предполагает автоматическую выдачу и продление сертификатов через протокол ACME?',
    options: [
      'Ручная генерация самоподписанных сертификатов',
      'Покупка Wildcard-сертификатов у коммерческого CA',
      'Автоматизация через Let\'s Encrypt (протокол ACME)',
      'Использование только внутреннего корпоративного CA',
    ],
    correctIndex: 2,
    explanation:
      'ACME (Automatic Certificate Management Environment) — протокол, разработанный для автоматизации выдачи, продления и отзыва TLS-сертификатов. Let\'s Encrypt — наиболее известный CA, использующий ACME для бесплатной автоматической выдачи сертификатов. Процесс: клиент (certbot, acme.sh) доказывает владение доменом через HTTP-challenge или DNS-challenge, после чего CA выдаёт сертификат сроком действия 90 дней с автоматическим продлением. Преимущества: нулевая стоимость, автоматизация, уменьшение человеческих ошибок. Ограничения: только DV-сертификаты (Domain Validation), не подходит для EV-сертификатов. В корпоративной среде ACME может использоваться и с внутренними CA (например, Vault PKI, Step-CA).',
  },
  {
    id: 'sa-security-019',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Что такое threat modeling (моделирование угроз)? Опишите методологию STRIDE и объясните, как аналитик может использовать её при проектировании системы.',
    sampleAnswer:
      'Threat modeling (моделирование угроз) — структурированный процесс выявления потенциальных угроз безопасности системы на этапе проектирования, до написания кода. Цель — определить, что может пойти не так, и предусмотреть контрмеры. STRIDE — методология Microsoft, классифицирующая угрозы по шести категориям: (1) Spoofing (подмена) — злоумышленник выдаёт себя за другого пользователя или систему. Контрмеры: строгая аутентификация, mTLS. (2) Tampering (подделка) — несанкционированное изменение данных. Контрмеры: цифровые подписи, контрольные суммы, аудит изменений. (3) Repudiation (отказ от авторства) — пользователь отрицает совершённое действие. Контрмеры: логирование, аудит, цифровые подписи. (4) Information Disclosure (утечка информации) — несанкционированный доступ к данным. Контрмеры: шифрование, контроль доступа, маскирование. (5) Denial of Service (отказ в обслуживании) — атака на доступность. Контрмеры: rate limiting, CDN, автомасштабирование. (6) Elevation of Privilege (повышение привилегий) — получение прав, которых быть не должно. Контрмеры: принцип наименьших привилегий, валидация ролей. Процесс: аналитик строит диаграмму потоков данных (DFD), определяет границы доверия (trust boundaries), применяет STRIDE к каждому элементу и документирует контрмеры.',
    explanation:
      'Threat modeling — один из наиболее эффективных способов повышения безопасности, потому что выявление угроз на этапе проектирования в десятки раз дешевле исправления уязвимостей в продакшне. Аналитик играет ключевую роль: он знает бизнес-логику, потоки данных и точки интеграции. Другие методологии: PASTA, OCTAVE, Attack Trees.',
  },
  {
    id: 'sa-security-020',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какая атака заключается в том, что злоумышленник заставляет браузер жертвы отправить нежелательный запрос к сайту, на котором жертва аутентифицирована?',
    options: [
      'Cross-Site Scripting (XSS)',
      'Cross-Site Request Forgery (CSRF)',
      'SQL Injection',
      'Clickjacking',
    ],
    correctIndex: 1,
    explanation:
      'Cross-Site Request Forgery (CSRF) — атака, при которой злоумышленник заставляет браузер аутентифицированного пользователя отправить нежелательный запрос (перевод денег, смена пароля, удаление данных) к сайту, на котором пользователь уже авторизован. Браузер автоматически прикладывает cookies (включая session cookie), поэтому сервер воспринимает запрос как легитимный. Пример: жертва посещает вредоносную страницу с тегом <img src="https://bank.com/transfer?to=attacker&amount=1000">, и браузер отправляет GET-запрос с cookies банка. Защита: CSRF-токены (уникальный токен в форме, проверяемый сервером), SameSite cookies (атрибут, ограничивающий отправку cookies с cross-origin запросами), проверка заголовка Origin/Referer. XSS — внедрение скриптов. Clickjacking — обман через невидимые iframe.',
  },
];
