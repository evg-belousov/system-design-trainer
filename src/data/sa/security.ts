import type { Question } from '../types';

export const securityQuestions: Question[] = [
  {
    id: 'sa-security-001',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какой из процессов отвечает за проверку подлинности пользователя (подтверждение, что пользователь — тот, за кого себя выдаёт)?',
    options: [
      'Идентификация',
      'Аутентификация',
      'Авторизация',
      'Аудит',
    ],
    correctIndex: 1,
    explanation:
      'Аутентификация — это процесс проверки подлинности субъекта, то есть подтверждения, что пользователь является тем, за кого себя выдаёт. Обычно осуществляется через ввод пароля, предъявление сертификата, биометрию или одноразовый код. Идентификация — предшествующий этап, на котором пользователь заявляет о своей личности (вводит логин, email). Авторизация — следующий этап, определяющий, какие действия и ресурсы доступны уже аутентифицированному пользователю. Аудит — запись действий пользователя для последующего анализа. Последовательность: идентификация -> аутентификация -> авторизация -> аудит.',
  },
  {
    id: 'sa-security-002',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'В чём принципиальное различие между шифрованием и хэшированием?',
    options: [
      'Шифрование быстрее хэширования',
      'Шифрование обратимо (данные можно восстановить), хэширование — необратимо (одностороннее преобразование)',
      'Хэширование используется только для файлов, шифрование — только для текста',
      'Хэширование всегда требует ключ, а шифрование — нет',
    ],
    correctIndex: 1,
    explanation:
      'Фундаментальное различие: шифрование — обратимая операция. Имея ключ (в симметричном шифровании — один ключ; в асимметричном — пару ключей), можно восстановить исходные данные. Используется для защиты данных при передаче и хранении (TLS, AES, RSA). Хэширование — необратимая (одностороннее) операция: из хэша невозможно восстановить исходные данные. Одинаковый вход всегда даёт одинаковый хэш (детерминированность). Используется для хранения паролей (bcrypt, Argon2), проверки целостности данных (SHA-256), цифровых подписей. Для паролей всегда используется хэширование (не шифрование!), потому что системе не нужно знать исходный пароль — достаточно сравнить хэши.',
  },
  {
    id: 'sa-security-003',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой стандартный протокол позволяет пользователю авторизовать сторонне приложение на доступ к своим данным без передачи логина и пароля этому приложению?',
    options: [
      'LDAP',
      'OAuth 2.0',
      'Kerberos',
      'SAML',
    ],
    correctIndex: 1,
    explanation:
      'OAuth 2.0 — протокол авторизации, который позволяет пользователю предоставить стороннему приложению ограниченный доступ к своим ресурсам (например, профилю, контактам) без раскрытия своих учётных данных. Приложение получает access token с определённым scope (набором разрешений). Пример: «Войти через Google» — пользователь авторизует приложение на чтение своего профиля Google, не передавая ему пароль от Google-аккаунта. LDAP — протокол доступа к каталогу (хранилищу пользователей), часто используется для аутентификации в корпоративной среде. Kerberos — протокол аутентификации на основе тикетов, широко используется в Active Directory. SAML — стандарт для обмена данными аутентификации/авторизации между identity provider и service provider (SSO в корпоративной среде).',
  },
  {
    id: 'sa-security-004',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Объясните разницу между симметричным и асимметричным шифрованием. Приведите примеры использования каждого типа в реальных системах.',
    sampleAnswer:
      'Симметричное шифрование использует один и тот же ключ для шифрования и дешифрования. Преимущество — высокая скорость, недостаток — необходимость безопасной передачи ключа обеим сторонам. Алгоритмы: AES (128/256 бит), ChaCha20. Применение: шифрование данных в базе, шифрование файлов, шифрование трафика внутри установленного TLS-соединения. Асимметричное шифрование использует пару ключей: открытый (public) для шифрования и закрытый (private) для дешифрования. Преимущество — не нужно передавать секретный ключ; недостаток — значительно медленнее симметричного. Алгоритмы: RSA, ECDSA, Ed25519. Применение: цифровые подписи, обмен ключами (key exchange) при установке TLS-соединения, SSH-аутентификация, PKI-сертификаты. На практике часто используется гибридный подход (TLS): асимметричное шифрование для безопасного обмена сессионным ключом, а затем симметричное шифрование для передачи данных — это сочетает безопасность асимметричной схемы со скоростью симметричной.',
    explanation:
      'Гибридный подход (асимметричное + симметричное) — стандарт в современных протоколах. TLS-рукопожатие (handshake): клиент и сервер при помощи асимметричного шифрования (или Diffie-Hellman) согласовывают симметричный сессионный ключ, которым затем шифруется весь трафик. Аналитик должен понимать эти основы для грамотного формулирования требований к защите данных при передаче и хранении.',
  },
  {
    id: 'sa-security-005',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Вы проектируете систему аутентификации и авторизации для микросервисной архитектуры с мобильным и веб-клиентами. Опишите архитектуру решения, выбор протоколов и механизмы обеспечения безопасности межсервисного взаимодействия.',
    sampleAnswer:
      'Архитектура: (1) Выделенный Identity Provider (IdP) — централизованный сервис аутентификации (Keycloak, Auth0 или собственная реализация). Хранит учётные записи, поддерживает MFA. (2) Протокол: OAuth 2.0 + OpenID Connect (OIDC). OAuth 2.0 — для авторизации (выдача access tokens), OIDC — надстройка для аутентификации (ID token с информацией о пользователе). (3) Потоки: для веб-приложения — Authorization Code Flow с PKCE (защита от перехвата authorization code); для мобильного — тот же Authorization Code Flow с PKCE (implicit flow устарел). (4) Токены: access token (JWT, короткоживущий, 5-15 мин) содержит claims: user_id, roles, scopes, exp; refresh token (длинноживущий, httpOnly cookie) для обновления access token без повторного ввода пароля. (5) API Gateway как точка валидации токенов: проверяет подпись JWT, срок действия, scope. Далее передаёт claims в заголовках внутренним сервисам. (6) Межсервисная авторизация: service-to-service — через client credentials grant (OAuth 2.0) или mTLS (mutual TLS). Каждый сервис имеет свой идентификатор и набор разрешений. (7) Безопасность: хранение паролей — bcrypt/Argon2; токены подписываются RS256 (асимметрично, чтобы сервисы могли верифицировать не имея приватного ключа); CORS-политики для веб-клиента; rate limiting на эндпоинтах аутентификации; защита от CSRF (SameSite cookies + CSRF-токены).',
    explanation:
      'Ключевые принципы: (1) Централизация аутентификации в IdP — единый источник правды. (2) Stateless-авторизация через JWT — не нужно обращаться к IdP при каждом запросе. (3) Принцип наименьших привилегий — минимальные scopes для каждого клиента и сервиса. (4) Defence in depth — валидация на уровне Gateway + повторная проверка в сервисах. (5) Zero Trust — не доверять внутренней сети, использовать mTLS между сервисами. Аналитик должен специфицировать матрицу ролей и разрешений, потоки аутентификации для каждого типа клиента и требования к безопасности хранения токенов.',
  },
  {
    id: 'sa-security-006',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой OAuth 2.0 flow рекомендуется для публичных клиентов (SPA, мобильные приложения) согласно современным рекомендациям безопасности?',
    options: [
      'Implicit Flow',
      'Resource Owner Password Credentials',
      'Authorization Code Flow с PKCE',
      'Client Credentials Flow',
    ],
    correctIndex: 2,
    explanation:
      'Authorization Code Flow с PKCE (Proof Key for Code Exchange) рекомендуется для всех публичных клиентов (SPA, мобильные и десктопные приложения). PKCE защищает от перехвата authorization code: клиент генерирует случайный code_verifier и отправляет его хэш (code_challenge) при запросе авторизации, а затем передаёт сам code_verifier при обмене кода на токен. Implicit Flow (токен возвращается прямо в URL-фрагменте) считается устаревшим из-за рисков утечки токена через историю браузера, referer-заголовки и логи. Resource Owner Password Credentials передаёт пароль напрямую через клиентское приложение — не рекомендуется. Client Credentials — для межсервисного (machine-to-machine) взаимодействия без участия пользователя.',
  },
  {
    id: 'sa-security-007',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что из перечисленного является примером многофакторной аутентификации (MFA)?',
    options: [
      'Ввод логина и пароля',
      'Ввод пароля и одноразового кода из SMS',
      'Ввод логина, пароля и секретного вопроса',
      'Использование двух разных паролей',
    ],
    correctIndex: 1,
    explanation:
      'Многофакторная аутентификация (MFA) требует предъявления двух или более факторов разных типов: (1) фактор знания — то, что пользователь знает (пароль, PIN, ответ на секретный вопрос); (2) фактор владения — то, что пользователь имеет (телефон для SMS/TOTP, аппаратный токен, смарт-карта); (3) фактор свойства — то, чем пользователь является (биометрия: отпечаток, лицо, голос). Ввод пароля + одноразовый код из SMS — это два разных фактора (знание + владение). Логин + пароль — один фактор (знание; логин — это идентификация, не аутентификация). Пароль + секретный вопрос — два экземпляра одного фактора (знание + знание), что не является полноценной MFA. Два пароля — аналогично, один фактор.',
  },
  {
    id: 'sa-security-008',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какая уязвимость из списка OWASP Top 10 связана с внедрением вредоносного кода в SQL-запросы через пользовательский ввод?',
    options: [
      'Cross-Site Scripting (XSS)',
      'SQL Injection',
      'Broken Access Control',
      'Security Misconfiguration',
    ],
    correctIndex: 1,
    explanation:
      'SQL Injection — уязвимость, при которой злоумышленник внедряет вредоносный SQL-код через пользовательский ввод (формы, URL-параметры), если приложение формирует SQL-запросы путём конкатенации строк без экранирования. Пример: ввод " OR 1=1 --" в поле логина может обойти аутентификацию. Защита: использование параметризованных запросов (prepared statements), ORM-фреймворков, валидация и санитизация ввода, принцип наименьших привилегий для учётной записи БД. SQL Injection входит в категорию «Injection» OWASP Top 10. XSS — внедрение скриптов в веб-страницу. Broken Access Control — ошибки в проверке прав доступа. Security Misconfiguration — небезопасная конфигурация.',
  },
  {
    id: 'sa-security-009',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое PKI (Public Key Infrastructure)?',
    options: [
      'Протокол передачи данных между клиентом и сервером',
      'Инфраструктура управления открытыми ключами, включающая удостоверяющие центры (CA), сертификаты и механизмы их проверки',
      'Фреймворк для автоматического тестирования безопасности',
      'Стандарт шифрования для баз данных',
    ],
    correctIndex: 1,
    explanation:
      'PKI (Public Key Infrastructure) — инфраструктура, обеспечивающая создание, распространение, управление и отзыв цифровых сертификатов. Основные компоненты: (1) CA (Certificate Authority) — удостоверяющий центр, выпускающий и подписывающий сертификаты (Let\'s Encrypt, DigiCert). (2) RA (Registration Authority) — проверяет идентичность запрашивающего сертификат. (3) Цифровые сертификаты (X.509) — связывают публичный ключ с идентичностью владельца. (4) CRL/OCSP — механизмы проверки отзыва сертификатов. PKI лежит в основе HTTPS/TLS: браузер проверяет сертификат сервера по цепочке доверия до корневого CA, что гарантирует подлинность сервера и шифрование трафика.',
  },
  {
    id: 'sa-security-010',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какая атака заключается во внедрении вредоносного JavaScript-кода в веб-страницу, которая затем выполняется в браузере других пользователей?',
    options: [
      'SQL Injection',
      'Cross-Site Request Forgery (CSRF)',
      'Cross-Site Scripting (XSS)',
      'Man-in-the-Middle (MITM)',
    ],
    correctIndex: 2,
    explanation:
      'Cross-Site Scripting (XSS) — атака, при которой злоумышленник внедряет вредоносный JavaScript-код в веб-страницу, и этот код исполняется в браузере жертвы. Типы XSS: (1) Reflected — вредоносный скрипт передаётся через URL-параметр и отражается в ответе сервера. (2) Stored — скрипт сохраняется на сервере (в БД, комментариях) и выполняется при каждом просмотре страницы. (3) DOM-based — манипуляция DOM на стороне клиента. Последствия: кража cookies/сессий, перенаправление на фишинговые сайты, выполнение действий от имени пользователя. Защита: экранирование вывода (output encoding), Content Security Policy (CSP), HttpOnly cookies, валидация ввода. CSRF — принуждение браузера жертвы к нежелательному запросу. MITM — перехват трафика.',
  },
  {
    id: 'sa-security-011',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'open',
    question: 'Что такое OWASP Top 10? Перечислите и кратко опишите хотя бы пять основных категорий уязвимостей.',
    sampleAnswer:
      'OWASP Top 10 — регулярно обновляемый список десяти наиболее критичных категорий уязвимостей веб-приложений, публикуемый организацией OWASP (Open Web Application Security Project). Основные категории (версия 2021): (1) Broken Access Control — ошибки контроля доступа: пользователи могут выполнять действия или просматривать данные, на которые у них нет прав (IDOR, обход авторизации). (2) Cryptographic Failures — ошибки в применении криптографии: передача данных без шифрования, использование устаревших алгоритмов, хранение паролей в открытом виде. (3) Injection — внедрение вредоносного кода (SQL Injection, XSS, OS Command Injection). (4) Insecure Design — небезопасная архитектура: отсутствие моделирования угроз, недостаточные проверки на уровне проектирования. (5) Security Misconfiguration — небезопасные настройки: открытые порты, дефолтные пароли, лишние права, включённые debug-режимы в продакшне. (6) Server-Side Request Forgery (SSRF) — сервер выполняет HTTP-запросы по URL, предоставленному пользователем, открывая доступ к внутренним ресурсам.',
    explanation:
      'OWASP Top 10 — отраслевой стандарт, который используется как чек-лист при проектировании и аудите безопасности. Аналитик должен знать эти уязвимости, чтобы формулировать требования к безопасности и участвовать в threat modeling. Каждая категория содержит рекомендации по предотвращению (prevention) и примеры сценариев атак.',
  },
  {
    id: 'sa-security-012',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое data masking (маскирование данных) и в каких случаях оно применяется?',
    options: [
      'Шифрование данных при передаче по сети',
      'Замена реальных чувствительных данных на фиктивные или частично скрытые значения для использования в непроизводственных средах',
      'Удаление всех персональных данных из базы данных',
      'Сжатие данных для экономии дискового пространства',
    ],
    correctIndex: 1,
    explanation:
      'Data masking (маскирование данных) — замена реальных чувствительных данных (ФИО, номера карт, email, телефоны) на фиктивные или частично скрытые значения, сохраняющие формат и реалистичность. Примеры: номер карты 4111-1111-1111-1234 → 4111-XXXX-XXXX-1234, ФИО «Иванов Иван» → «Петров Сергей». Применение: (1) тестовые среды — разработчики и тестировщики работают с реалистичными, но не настоящими данными; (2) аналитика — предоставление данных аналитикам без раскрытия персональной информации; (3) соответствие регуляторным требованиям (GDPR, PCI DSS, 152-ФЗ). Типы: статическое маскирование (создание отдельной замаскированной копии), динамическое маскирование (данные маскируются на лету при запросе в зависимости от роли пользователя).',
  },
  {
    id: 'sa-security-013',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой принцип лежит в основе архитектуры Zero Trust?',
    options: [
      'Все устройства внутри корпоративной сети считаются доверенными по умолчанию',
      'Никому и ничему не доверять по умолчанию — каждый запрос должен быть аутентифицирован и авторизован независимо от расположения в сети',
      'Безопасность обеспечивается исключительно через VPN и файрвол',
      'Все данные должны шифроваться только при хранении, но не при передаче',
    ],
    correctIndex: 1,
    explanation:
      'Zero Trust (нулевое доверие) — модель безопасности, основанная на принципе «никогда не доверяй, всегда проверяй» (never trust, always verify). В отличие от традиционного периметрового подхода (всё внутри сети — доверенное), Zero Trust предполагает: (1) каждый запрос аутентифицируется и авторизуется независимо от расположения источника (внутренняя сеть не является гарантией доверия); (2) принцип наименьших привилегий — минимально необходимый доступ; (3) микросегментация — сеть разделена на мелкие зоны с контролем доступа; (4) непрерывная верификация — проверка не только при входе, но при каждом запросе к ресурсу; (5) шифрование трафика внутри сети (mTLS). Zero Trust стал особенно актуален с распространением облаков и удалённой работы, когда понятие «периметра» размывается.',
  },
  {
    id: 'sa-security-014',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Объясните разницу между security audit (аудит безопасности) и penetration testing (тестирование на проникновение). Когда применяется каждый подход?',
    sampleAnswer:
      'Security audit (аудит безопасности) — систематическая оценка соответствия системы установленным стандартам, политикам и лучшим практикам безопасности. Аудит проверяет: конфигурации серверов и сетевого оборудования, политики доступа, процедуры управления уязвимостями, соответствие стандартам (PCI DSS, ISO 27001, GDPR). Аудит носит более формальный и всесторонний характер, может быть внутренним или внешним, обязательным (для сертификации) или добровольным. Penetration testing (пентест) — моделирование реальной атаки на систему для выявления эксплуатируемых уязвимостей. Пентестер пытается проникнуть в систему, используя те же техники, что и злоумышленник: сканирование портов, поиск уязвимостей, эксплуатация найденных слабостей, эскалация привилегий. Виды: Black Box (пентестер ничего не знает о системе), White Box (полный доступ к коду и документации), Gray Box (частичная информация). Аудит отвечает на вопрос «соответствует ли система стандартам», пентест — на вопрос «можно ли взломать систему». Оба подхода дополняют друг друга и должны проводиться регулярно.',
    explanation:
      'Аудит и пентест — два столпа проверки безопасности. Аудит выявляет организационные и процессные пробелы. Пентест выявляет технические уязвимости, которые можно реально эксплуатировать. Аналитик участвует в определении scope аудита и пентеста, подготовке документации и анализе результатов.',
  },
  {
    id: 'sa-security-015',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой стандарт устанавливает требования к безопасности обработки данных платёжных карт?',
    options: [
      'GDPR',
      'ISO 27001',
      'PCI DSS',
      'SOC 2',
    ],
    correctIndex: 2,
    explanation:
      'PCI DSS (Payment Card Industry Data Security Standard) — стандарт безопасности, разработанный Советом PCI (объединяющим Visa, Mastercard, American Express и др.) для организаций, обрабатывающих, хранящих или передающих данные платёжных карт. PCI DSS включает 12 основных требований: установка файрволов, защита хранимых данных карт, шифрование при передаче, антивирусная защита, управление доступом, мониторинг и тестирование, политика безопасности. Несоблюдение PCI DSS грозит штрафами и запретом на обработку карт. GDPR — регулирование защиты персональных данных в ЕС. ISO 27001 — стандарт управления информационной безопасностью (ISMS). SOC 2 — стандарт контроля безопасности для сервис-провайдеров.',
  },
  {
    id: 'sa-security-016',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой механизм обеспечивает взаимную аутентификацию клиента и сервера с помощью TLS-сертификатов?',
    options: [
      'OAuth 2.0 Client Credentials',
      'Mutual TLS (mTLS)',
      'API Key Authentication',
      'Basic Authentication',
    ],
    correctIndex: 1,
    explanation:
      'Mutual TLS (mTLS) — режим TLS-соединения, при котором не только сервер предъявляет сертификат клиенту (стандартный TLS), но и клиент предъявляет свой сертификат серверу. Это обеспечивает взаимную аутентификацию: обе стороны убеждены в подлинности друг друга. Применение: межсервисное взаимодействие в микросервисной архитектуре (Service Mesh / Istio), банковские API, IoT-устройства, Zero Trust архитектура. Преимущества: криптографически стойкая аутентификация, не передаются пароли/токены. Сложности: управление сертификатами (выпуск, ротация, отзыв), необходимость PKI-инфраструктуры. OAuth Client Credentials использует client_id/secret. API Key — статический ключ. Basic Auth — логин/пароль в заголовке.',
  },
  {
    id: 'sa-security-017',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Опишите основные требования GDPR (General Data Protection Regulation) с точки зрения проектирования информационных систем. Какие архитектурные решения должен предусмотреть аналитик?',
    sampleAnswer:
      'GDPR (General Data Protection Regulation) — регламент ЕС о защите персональных данных, вступивший в силу в 2018 году. Основные требования и архитектурные решения: (1) Privacy by Design — защита данных должна быть заложена в архитектуру, а не добавлена постфактум. Аналитик должен предусмотреть минимизацию данных (собирать только необходимое), разделение PII (Personally Identifiable Information) от бизнес-данных, шифрование и псевдонимизацию. (2) Право на удаление (Right to Erasure) — система должна поддерживать полное удаление персональных данных по запросу пользователя. Архитектурно: выделение PII в отдельные хранилища или поля для возможности точечного удаления, мягкое удаление с последующей жёсткой очисткой, каскадное удаление связанных данных. (3) Право на переносимость (Data Portability) — пользователь может запросить экспорт своих данных в машиночитаемом формате (JSON, CSV). (4) Согласие (Consent) — система должна получать явное согласие, хранить его историю, позволять отзыв. (5) Уведомление об утечке — автоматический мониторинг и оповещение в течение 72 часов. (6) Реестр обработок — документация всех процессов обработки персональных данных. (7) DPO (Data Protection Officer) — назначение ответственного лица.',
    explanation:
      'GDPR влияет на архитектуру на всех уровнях: модель данных (разделение PII), API (эндпоинты для прав субъекта), хранение (шифрование, retention policies), логирование (не логировать PII), интеграции (DPA — Data Processing Agreements с третьими сторонами). Аналитик должен участвовать в DPIA (Data Protection Impact Assessment) и формулировать требования к реализации каждого права субъекта данных.',
  },
  {
    id: 'sa-security-018',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой подход к управлению сертификатами предполагает автоматическую выдачу и продление сертификатов через протокол ACME?',
    options: [
      'Ручная генерация самоподписанных сертификатов',
      'Покупка Wildcard-сертификатов у коммерческого CA',
      'Автоматизация через Let\'s Encrypt (протокол ACME)',
      'Использование только внутреннего корпоративного CA',
    ],
    correctIndex: 2,
    explanation:
      'ACME (Automatic Certificate Management Environment) — протокол, разработанный для автоматизации выдачи, продления и отзыва TLS-сертификатов. Let\'s Encrypt — наиболее известный CA, использующий ACME для бесплатной автоматической выдачи сертификатов. Процесс: клиент (certbot, acme.sh) доказывает владение доменом через HTTP-challenge или DNS-challenge, после чего CA выдаёт сертификат сроком действия 90 дней с автоматическим продлением. Преимущества: нулевая стоимость, автоматизация, уменьшение человеческих ошибок. Ограничения: только DV-сертификаты (Domain Validation), не подходит для EV-сертификатов. В корпоративной среде ACME может использоваться и с внутренними CA (например, Vault PKI, Step-CA).',
  },
  {
    id: 'sa-security-019',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Что такое threat modeling (моделирование угроз)? Опишите методологию STRIDE и объясните, как аналитик может использовать её при проектировании системы.',
    sampleAnswer:
      'Threat modeling (моделирование угроз) — структурированный процесс выявления потенциальных угроз безопасности системы на этапе проектирования, до написания кода. Цель — определить, что может пойти не так, и предусмотреть контрмеры. STRIDE — методология Microsoft, классифицирующая угрозы по шести категориям: (1) Spoofing (подмена) — злоумышленник выдаёт себя за другого пользователя или систему. Контрмеры: строгая аутентификация, mTLS. (2) Tampering (подделка) — несанкционированное изменение данных. Контрмеры: цифровые подписи, контрольные суммы, аудит изменений. (3) Repudiation (отказ от авторства) — пользователь отрицает совершённое действие. Контрмеры: логирование, аудит, цифровые подписи. (4) Information Disclosure (утечка информации) — несанкционированный доступ к данным. Контрмеры: шифрование, контроль доступа, маскирование. (5) Denial of Service (отказ в обслуживании) — атака на доступность. Контрмеры: rate limiting, CDN, автомасштабирование. (6) Elevation of Privilege (повышение привилегий) — получение прав, которых быть не должно. Контрмеры: принцип наименьших привилегий, валидация ролей. Процесс: аналитик строит диаграмму потоков данных (DFD), определяет границы доверия (trust boundaries), применяет STRIDE к каждому элементу и документирует контрмеры.',
    explanation:
      'Threat modeling — один из наиболее эффективных способов повышения безопасности, потому что выявление угроз на этапе проектирования в десятки раз дешевле исправления уязвимостей в продакшне. Аналитик играет ключевую роль: он знает бизнес-логику, потоки данных и точки интеграции. Другие методологии: PASTA, OCTAVE, Attack Trees.',
  },
  {
    id: 'sa-security-020',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какая атака заключается в том, что злоумышленник заставляет браузер жертвы отправить нежелательный запрос к сайту, на котором жертва аутентифицирована?',
    options: [
      'Cross-Site Scripting (XSS)',
      'Cross-Site Request Forgery (CSRF)',
      'SQL Injection',
      'Clickjacking',
    ],
    correctIndex: 1,
    explanation:
      'Cross-Site Request Forgery (CSRF) — атака, при которой злоумышленник заставляет браузер аутентифицированного пользователя отправить нежелательный запрос (перевод денег, смена пароля, удаление данных) к сайту, на котором пользователь уже авторизован. Браузер автоматически прикладывает cookies (включая session cookie), поэтому сервер воспринимает запрос как легитимный. Пример: жертва посещает вредоносную страницу с тегом <img src="https://bank.com/transfer?to=attacker&amount=1000">, и браузер отправляет GET-запрос с cookies банка. Защита: CSRF-токены (уникальный токен в форме, проверяемый сервером), SameSite cookies (атрибут, ограничивающий отправку cookies с cross-origin запросами), проверка заголовка Origin/Referer. XSS — внедрение скриптов. Clickjacking — обман через невидимые iframe.',
  },
  {
    id: 'sa-security-021',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое HTTPS и чем он отличается от HTTP?',
    options: [
      'Более быстрая версия HTTP',
      'HTTP с шифрованием через TLS/SSL, обеспечивающий конфиденциальность и целостность данных',
      'Протокол для передачи файлов',
      'Протокол для работы с базами данных',
    ],
    correctIndex: 1,
    explanation:
      'HTTPS (HTTP Secure) — HTTP поверх TLS/SSL. Обеспечивает: конфиденциальность (шифрование данных — перехват бесполезен), целостность (данные не могут быть незаметно изменены), аутентификацию сервера (сертификат подтверждает идентичность). По умолчанию использует порт 443 (HTTP — 80). Современные браузеры помечают HTTP-сайты как небезопасные. HTTPS обязателен для любых форм с паролями, персональными данными, платежами. Let\'s Encrypt предоставляет бесплатные сертификаты.',
  },
  {
    id: 'sa-security-022',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какой алгоритм рекомендуется для безопасного хранения паролей в базе данных?',
    options: [
      'MD5',
      'SHA-1',
      'bcrypt или Argon2',
      'Base64',
    ],
    correctIndex: 2,
    explanation:
      'bcrypt и Argon2 — специализированные алгоритмы хэширования паролей, разработанные для защиты от brute-force и rainbow table атак. Особенности: работа-фактор (cost factor) — настраиваемая «медленность» для усложнения перебора; соль (salt) — уникальная для каждого пароля, предотвращает rainbow tables; Argon2 (победитель Password Hashing Competition 2015) также требует много памяти, усложняя GPU-атаки. MD5 и SHA-1 — устаревшие и слишком быстрые для паролей (миллиарды хэшей в секунду на GPU). Base64 — кодирование, не хэширование.',
  },
  {
    id: 'sa-security-023',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое принцип наименьших привилегий (Principle of Least Privilege)?',
    options: [
      'Все пользователи должны иметь права администратора',
      'Пользователю или процессу предоставляются только те права, которые необходимы для выполнения задачи',
      'Права должны наследоваться от родительских объектов',
      'Все действия должны логироваться',
    ],
    correctIndex: 1,
    explanation:
      'Principle of Least Privilege (PoLP) — принцип безопасности, согласно которому субъекту (пользователю, процессу, сервису) предоставляются только минимально необходимые права для выполнения его задач. Примеры: сервис БД работает под учётной записью без root-прав; приложение подключается к БД с правами только на нужные таблицы; сотрудник получает доступ только к своему отделу. Это ограничивает ущерб при компрометации: атакующий получает только те права, что были у скомпрометированного субъекта.',
  },
  {
    id: 'sa-security-024',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'open',
    question: 'Что такое JWT (JSON Web Token)? Из каких частей он состоит и для чего используется?',
    sampleAnswer:
      'JWT (JSON Web Token) — компактный самодостаточный способ передачи информации между сторонами в виде JSON-объекта, подписанного цифровой подписью. Структура (три части, разделённые точками): (1) Header — алгоритм подписи (HS256, RS256) и тип токена. (2) Payload — полезная нагрузка: claims (утверждения) — стандартные (iss, sub, exp, iat) и кастомные (user_id, roles). (3) Signature — подпись для проверки целостности: HMACSHA256(base64(header) + "." + base64(payload), secret). Применение: аутентификация (access tokens в OAuth 2.0), авторизация (передача ролей/прав), обмен информацией между сервисами. Преимущества: stateless (не нужно хранить сессии на сервере), самодостаточность (содержит всю нужную информацию). Важно: payload закодирован (base64), но НЕ зашифрован — не хранить в JWT конфиденциальные данные; использовать короткое время жизни; передавать только по HTTPS.',
    explanation:
      'JWT стал стандартом для токенов в современных API. Ключевое отличие от session-based auth: сервер не хранит состояние, все данные в токене. Риски: если секрет скомпрометирован — все токены невалидны; отозвать отдельный JWT до истечения сложно (нужен blacklist или short-lived tokens + refresh tokens).',
  },
  {
    id: 'sa-security-025',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какая методология моделирования угроз классифицирует риски по категориям: Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege?',
    options: [
      'DREAD',
      'STRIDE',
      'PASTA',
      'OCTAVE',
    ],
    correctIndex: 1,
    explanation:
      'STRIDE — методология моделирования угроз Microsoft, классифицирующая угрозы по шести категориям: Spoofing (подмена идентичности), Tampering (подделка данных), Repudiation (отказ от авторства), Information Disclosure (утечка информации), Denial of Service (отказ в обслуживании), Elevation of Privilege (повышение привилегий). DREAD — методология оценки рисков (Damage, Reproducibility, Exploitability, Affected users, Discoverability). PASTA — Process for Attack Simulation and Threat Analysis. OCTAVE — Operationally Critical Threat, Asset, and Vulnerability Evaluation.',
  },
  {
    id: 'sa-security-026',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое Secrets Management и зачем он нужен?',
    options: [
      'Управление паролями пользователей',
      'Безопасное хранение, доступ и ротация секретов (API-ключей, паролей, сертификатов) для приложений и инфраструктуры',
      'Шифрование базы данных',
      'Система резервного копирования',
    ],
    correctIndex: 1,
    explanation:
      'Secrets Management — практика и инструменты для безопасного хранения, доступа, аудита и ротации секретов: API-ключей, паролей БД, TLS-сертификатов, токенов. Проблема: секреты в коде, конфигах, environment variables легко утекают (Git history, логи, docker images). Решения: HashiCorp Vault, AWS Secrets Manager, Azure Key Vault, Google Secret Manager. Функции: централизованное хранение с шифрованием, контроль доступа (policies), аудит обращений, автоматическая ротация, динамические секреты (короткоживущие credentials). Секреты инжектируются в приложение через API или environment variables, но не хранятся в коде.',
  },
  {
    id: 'sa-security-027',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое DREAD в контексте оценки рисков безопасности?',
    options: [
      'Тип сетевой атаки',
      'Методология количественной оценки рисков по пяти критериям: Damage, Reproducibility, Exploitability, Affected users, Discoverability',
      'Протокол шифрования',
      'Стандарт аутентификации',
    ],
    correctIndex: 1,
    explanation:
      'DREAD — методология оценки рисков угроз, где каждая угроза оценивается по пяти критериям (обычно 1-10): Damage (потенциальный ущерб), Reproducibility (воспроизводимость атаки), Exploitability (сложность эксплуатации), Affected users (количество затронутых пользователей), Discoverability (вероятность обнаружения уязвимости злоумышленником). Итоговый риск = среднее или сумма оценок. DREAD часто используется вместе со STRIDE: STRIDE выявляет угрозы, DREAD приоритизирует их. Microsoft сейчас рекомендует другие подходы (CVSS), но DREAD остаётся популярен за простоту.',
  },
  {
    id: 'sa-security-028',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Что такое Secure SDLC (Secure Software Development Life Cycle)? Какие практики безопасности должны быть интегрированы на каждом этапе?',
    sampleAnswer:
      'Secure SDLC — интеграция практик безопасности в каждый этап жизненного цикла разработки ПО, вместо проверки безопасности только перед релизом. Практики по этапам: (1) Требования: определение требований безопасности (NFR), классификация данных, compliance-требования (GDPR, PCI DSS), abuse cases (негативные сценарии). (2) Проектирование: threat modeling (STRIDE), security architecture review, выбор безопасных паттернов, принцип defense in depth. (3) Разработка: secure coding guidelines, статический анализ кода (SAST — SonarQube, Checkmarx), code review с фокусом на безопасность, использование проверенных библиотек. (4) Тестирование: динамическое тестирование (DAST — OWASP ZAP, Burp Suite), penetration testing, fuzz testing, проверка зависимостей (SCA — Snyk, Dependabot). (5) Развёртывание: hardening инфраструктуры, secrets management, security configurations, WAF. (6) Эксплуатация: мониторинг безопасности (SIEM), incident response plan, регулярные security audits, patch management. Подходы: Microsoft SDL, OWASP SAMM, BSIMM.',
    explanation:
      'Shift-left security — ключевой принцип: чем раньше найдена уязвимость, тем дешевле её исправить. DevSecOps интегрирует security в CI/CD pipeline: SAST, DAST, SCA выполняются автоматически при каждом коммите. Аналитик участвует в определении security requirements и threat modeling.',
  },
  {
    id: 'sa-security-029',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой HTTP-заголовок используется для защиты от Clickjacking-атак?',
    options: [
      'Content-Security-Policy',
      'X-Frame-Options',
      'X-XSS-Protection',
      'Strict-Transport-Security',
    ],
    correctIndex: 1,
    explanation:
      'X-Frame-Options — HTTP-заголовок, контролирующий, может ли страница быть встроена в <frame>, <iframe>, <embed>, <object>. Значения: DENY (запрет встраивания), SAMEORIGIN (только с того же origin), ALLOW-FROM uri (устаревший, не поддерживается современными браузерами). Защищает от Clickjacking — атаки, при которой злоумышленник накладывает невидимый iframe с целевым сайтом поверх своей страницы, заставляя пользователя кликать по скрытым элементам. Современный подход: frame-ancestors директива в Content-Security-Policy. Strict-Transport-Security — HTTPS enforcement. X-XSS-Protection — устаревший заголовок для XSS-фильтра браузера.',
  },
  {
    id: 'sa-security-030',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое RBAC (Role-Based Access Control)?',
    options: [
      'Контроль доступа на основе атрибутов пользователя',
      'Модель контроля доступа, где права назначаются ролям, а пользователям назначаются роли',
      'Контроль доступа на основе времени суток',
      'Контроль доступа на основе местоположения',
    ],
    correctIndex: 1,
    explanation:
      'RBAC (Role-Based Access Control) — модель управления доступом, где: права (permissions) назначаются ролям (roles); роли назначаются пользователям (users). Пример: роль «Редактор» имеет права create_article, edit_article; пользователь получает роль «Редактор» и наследует её права. Преимущества: упрощение администрирования (управление ролями, а не отдельными правами каждого пользователя), соответствие организационной структуре, аудит. Альтернативы: ABAC (Attribute-Based) — решения на основе атрибутов (отдел, должность, время), более гибкий, но сложнее; DAC (Discretionary) — владелец ресурса определяет права; MAC (Mandatory) — централизованные метки безопасности.',
  },
  {
    id: 'sa-security-031',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Что такое SAST и DAST в контексте тестирования безопасности?',
    options: [
      'Типы шифрования данных',
      'Статический (анализ кода без выполнения) и динамический (тестирование работающего приложения) анализ безопасности',
      'Протоколы аутентификации',
      'Методы резервного копирования',
    ],
    correctIndex: 1,
    explanation:
      'SAST (Static Application Security Testing) — анализ исходного кода или байт-кода без выполнения приложения. Выявляет: SQL injection, XSS, hardcoded credentials, небезопасные функции. Инструменты: SonarQube, Checkmarx, Fortify, Semgrep. Плюсы: раннее обнаружение, покрытие всего кода. Минусы: много false positives, не видит runtime-проблемы. DAST (Dynamic Application Security Testing) — тестирование работающего приложения «снаружи» (как атакующий). Выявляет: инъекции, XSS, misconfigurations, authentication issues. Инструменты: OWASP ZAP, Burp Suite, Acunetix. Плюсы: реальные уязвимости, мало false positives. Минусы: требует развёрнутое приложение, не покрывает весь код. Комбинация SAST + DAST даёт наилучшее покрытие.',
  },
  {
    id: 'sa-security-032',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой стандарт определяет систему менеджмента информационной безопасности (ISMS)?',
    options: [
      'PCI DSS',
      'ISO/IEC 27001',
      'GDPR',
      'HIPAA',
    ],
    correctIndex: 1,
    explanation:
      'ISO/IEC 27001 — международный стандарт, определяющий требования к системе менеджмента информационной безопасности (ISMS — Information Security Management System). Включает: оценку рисков, политики безопасности, контроли (Annex A — 114 контролей в 14 доменах), постоянное улучшение (PDCA-цикл). Сертификация ISO 27001 подтверждает, что организация систематически управляет рисками ИБ. ISO 27002 — детальные рекомендации по реализации контролей. PCI DSS — стандарт для платёжных карт. GDPR — регламент защиты данных ЕС. HIPAA — защита медицинских данных (США).',
  },
  {
    id: 'sa-security-033',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Опишите процесс реагирования на инцидент информационной безопасности (Incident Response). Какие фазы включает этот процесс?',
    sampleAnswer:
      'Incident Response — структурированный подход к обнаружению, анализу, сдерживанию и восстановлению после инцидентов безопасности. Фазы (NIST SP 800-61): (1) Подготовка (Preparation): создание IR-команды, разработка плана реагирования, инструменты (SIEM, forensics), обучение персонала, контакты (legal, PR, правоохранительные органы). (2) Обнаружение и анализ (Detection & Analysis): мониторинг алертов (SIEM, IDS), триаж — определение severity и impact, первичный анализ — что произошло, какие системы затронуты, IOC (Indicators of Compromise). (3) Сдерживание (Containment): краткосрочное — изоляция заражённых систем (отключение от сети), блокировка учётных записей; долгосрочное — патчинг, смена credentials, сохранение evidence для forensics. (4) Устранение (Eradication): удаление malware, закрытие уязвимостей, восстановление систем из чистых бэкапов. (5) Восстановление (Recovery): возврат систем в production, усиленный мониторинг, верификация нормальной работы. (6) Извлечение уроков (Post-Incident Activity): RCA (Root Cause Analysis), обновление процедур и контролей, отчёт руководству.',
    explanation:
      'Incident Response Plan должен быть документирован и протестирован ДО инцидента (tabletop exercises, simulations). Время реагирования критично — чем дольше атакующий в системе, тем больше ущерб. Аналитик участвует в определении процедур эскалации, коммуникации со стейкхолдерами и post-mortem анализе.',
  },
  {
    id: 'sa-security-034',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Что такое SOC 2 и для чего используется этот стандарт?',
    options: [
      'Стандарт шифрования данных',
      'Фреймворк аудита для сервис-провайдеров, оценивающий контроли безопасности, доступности, целостности обработки, конфиденциальности и приватности',
      'Протокол сетевой безопасности',
      'Методология разработки ПО',
    ],
    correctIndex: 1,
    explanation:
      'SOC 2 (Service Organization Control 2) — стандарт аудита AICPA для сервис-провайдеров (SaaS, облачные сервисы, дата-центры), оценивающий контроли по пяти Trust Services Criteria: Security (защита от несанкционированного доступа), Availability (доступность системы), Processing Integrity (точность обработки), Confidentiality (защита конфиденциальной информации), Privacy (защита персональных данных). Типы отчётов: Type I — дизайн контролей на определённую дату; Type II — эффективность работы контролей за период (6-12 месяцев). SOC 2 Type II — стандартное требование enterprise-клиентов к SaaS-провайдерам.',
  },
  {
    id: 'sa-security-035',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Как организовать безопасное хранение и управление секретами в микросервисной архитектуре? Опишите архитектуру решения.',
    sampleAnswer:
      'Архитектура Secrets Management для микросервисов: (1) Централизованное хранилище секретов: HashiCorp Vault (self-hosted) или облачные решения (AWS Secrets Manager, Azure Key Vault). Vault обеспечивает: шифрование at rest и in transit, контроль доступа (policies), аудит всех обращений, версионирование секретов. (2) Аутентификация сервисов в Vault: Kubernetes Service Account (в K8s), IAM Role (в AWS), AppRole (универсальный). Сервис аутентифицируется без hardcoded credentials. (3) Получение секретов: sidecar-контейнер (vault-agent) инжектирует секреты в файл или environment; прямой API-вызов к Vault при старте приложения; Kubernetes Secrets с внешним secrets operator (External Secrets Operator). (4) Динамические секреты: Vault генерирует короткоживущие credentials для БД (database secrets engine); при компрометации ущерб ограничен временем жизни секрета. (5) Ротация: автоматическая периодическая ротация статических секретов; немедленная ротация при подозрении на компрометацию. (6) Мониторинг: алерты на аномальные запросы к секретам, audit log для compliance. (7) Не делать: секреты в коде/конфигах, environment variables видимые в ps/proc, логирование значений секретов.',
    explanation:
      'Secrets Management — критическая часть безопасности. Vault — industry standard, но требует operational overhead. Облачные решения (AWS Secrets Manager) проще в эксплуатации. Ключевой принцип: секрет не должен существовать в plaintext нигде, кроме памяти использующего его процесса.',
  },
  {
    id: 'sa-security-036',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое брутфорс-атака (Brute Force Attack)?',
    options: [
      'Атака через уязвимость в ПО',
      'Перебор всех возможных комбинаций паролей или ключей для получения доступа',
      'Перехват сетевого трафика',
      'Социальная инженерия',
    ],
    correctIndex: 1,
    explanation:
      'Brute Force Attack — метод атаки, при котором злоумышленник перебирает все возможные комбинации паролей, ключей или токенов. Варианты: простой перебор (все комбинации), dictionary attack (популярные пароли), credential stuffing (утёкшие пары логин-пароль с других сайтов). Защита: сложные длинные пароли, rate limiting (ограничение попыток), CAPTCHA после нескольких неудач, account lockout, MFA, мониторинг аномалий. Современные GPU позволяют перебирать миллиарды хэшей в секунду, поэтому важны медленные алгоритмы хэширования паролей (bcrypt, Argon2).',
  },
  {
    id: 'sa-security-037',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Какой заголовок HTTP сообщает браузеру использовать только HTTPS для данного домена?',
    options: [
      'Content-Security-Policy',
      'Strict-Transport-Security (HSTS)',
      'X-Content-Type-Options',
      'Access-Control-Allow-Origin',
    ],
    correctIndex: 1,
    explanation:
      'HSTS (HTTP Strict-Transport-Security) — заголовок, указывающий браузеру обращаться к сайту только по HTTPS. После получения HSTS браузер автоматически преобразует все HTTP-запросы к домену в HTTPS и не позволяет пользователю обойти предупреждения о сертификате. Параметры: max-age (время действия), includeSubDomains, preload (включение в hardcoded список браузеров). Защищает от: downgrade-атак, SSL stripping, случайных HTTP-запросов. Content-Security-Policy — защита от XSS. X-Content-Type-Options — защита от MIME-sniffing.',
  },
  {
    id: 'sa-security-038',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое Content Security Policy (CSP)?',
    options: [
      'Политика резервного копирования',
      'HTTP-заголовок, определяющий, какие ресурсы (скрипты, стили, изображения) могут загружаться на страницу',
      'Протокол шифрования контента',
      'Правила кэширования контента',
    ],
    correctIndex: 1,
    explanation:
      'Content Security Policy (CSP) — HTTP-заголовок, позволяющий контролировать, какие ресурсы могут загружаться и выполняться на странице. Директивы: script-src (источники скриптов), style-src (стили), img-src (изображения), connect-src (AJAX/WebSocket), frame-ancestors (кто может встраивать страницу). Защита от XSS: запрет inline-скриптов (script-src \'self\'), запрет eval(). Режимы: report-only (только логирование нарушений) для тестирования, enforce (блокировка). CSP — один из наиболее эффективных механизмов защиты от XSS, но требует тщательной настройки.',
  },
  {
    id: 'sa-security-039',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'open',
    question: 'Что такое Defense in Depth (эшелонированная защита)? Приведите примеры применения этого принципа.',
    sampleAnswer:
      'Defense in Depth (эшелонированная защита, глубокоэшелонированная оборона) — стратегия безопасности, предполагающая множество независимых слоёв защиты. Если один слой преодолён, остальные продолжают защищать систему. Слои и примеры: (1) Физический: контроль доступа в дата-центр, видеонаблюдение, биометрия. (2) Сетевой: файрволы, IDS/IPS, сегментация сети, VPN, DDoS-защита. (3) Хостовый: антивирус, host-based firewall, hardening ОС, patch management. (4) Приложения: WAF, input validation, output encoding, secure coding, SAST/DAST. (5) Данных: шифрование at rest и in transit, access control, data masking, backup. (6) Идентичности: MFA, strong passwords, least privilege, identity management. (7) Процессный: security awareness, incident response, security policies. Пример веб-приложения: WAF фильтрует атаки → приложение валидирует ввод → БД использует параметризованные запросы → данные зашифрованы. Даже если WAF обойдён, другие слои защищают.',
    explanation:
      'Defense in Depth исходит из предположения, что любой один контроль может быть обойдён. Множество независимых контролей экспоненциально усложняют задачу атакующего. Аналитик должен проектировать системы с несколькими линиями защиты, особенно для критичных данных и функций.',
  },
  {
    id: 'sa-security-040',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Что такое SIEM (Security Information and Event Management)?',
    options: [
      'Протокол шифрования',
      'Система сбора, корреляции и анализа событий безопасности из различных источников для обнаружения угроз',
      'Инструмент для сканирования уязвимостей',
      'Система резервного копирования',
    ],
    correctIndex: 1,
    explanation:
      'SIEM (Security Information and Event Management) — платформа для централизованного сбора, хранения, корреляции и анализа событий безопасности из множества источников: логи серверов, сетевого оборудования, приложений, endpoint-агенты. Функции: real-time мониторинг, корреляция событий (выявление паттернов атак), alerting, forensic analysis, compliance reporting. Примеры: Splunk, IBM QRadar, Microsoft Sentinel, Elastic SIEM. SIEM — центр Security Operations Center (SOC). Правила корреляции выявляют: brute force (множество неудачных логинов), lateral movement (аномальные подключения), data exfiltration (необычный объём исходящего трафика).',
  },
  {
    id: 'sa-security-041',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Какой тип атаки использует легитимные учётные данные, украденные с других скомпрометированных сервисов?',
    options: [
      'Brute Force',
      'Credential Stuffing',
      'SQL Injection',
      'Man-in-the-Middle',
    ],
    correctIndex: 1,
    explanation:
      'Credential Stuffing — атака, при которой злоумышленник использует базы утёкших пар логин-пароль с других сервисов, надеясь, что пользователи используют одинаковые учётные данные на разных сайтах. Эффективность: 0.1-2% успешных входов — достаточно для массовой компрометации. Защита: MFA, проверка паролей по базам утечек (Have I Been Pwned API), rate limiting, CAPTCHA, обнаружение аномалий (геолокация, устройство), требование уникальных паролей (password managers). Отличие от Brute Force: используются реальные пароли, а не перебор.',
  },
  {
    id: 'sa-security-042',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое WAF (Web Application Firewall)?',
    options: [
      'Сетевой файрвол уровня L3/L4',
      'Файрвол уровня приложения (L7), фильтрующий HTTP-трафик и защищающий от атак на веб-приложения',
      'Система обнаружения вторжений',
      'Прокси-сервер для кэширования',
    ],
    correctIndex: 1,
    explanation:
      'WAF (Web Application Firewall) — файрвол уровня приложения, анализирующий HTTP/HTTPS-трафик и защищающий от атак: SQL Injection, XSS, CSRF, file inclusion, path traversal. Режимы работы: блокировка (block), мониторинг (detect), whitelist/blacklist. Реализации: облачные (Cloudflare, AWS WAF, Azure WAF), on-premise (ModSecurity), встроенные в CDN. Правила: сигнатуры известных атак (OWASP Core Rule Set), аномалии (необычные паттерны), rate limiting. WAF — слой защиты, но не замена secure coding (может быть обойдён). Работает на L7, в отличие от network firewall (L3/L4).',
  },
  {
    id: 'sa-security-043',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое OpenID Connect и как он связан с OAuth 2.0?',
    options: [
      'Альтернатива OAuth 2.0 для авторизации',
      'Слой аутентификации поверх OAuth 2.0, добавляющий ID Token с информацией о пользователе',
      'Протокол для передачи файлов',
      'Стандарт шифрования токенов',
    ],
    correctIndex: 1,
    explanation:
      'OpenID Connect (OIDC) — протокол аутентификации, построенный поверх OAuth 2.0. OAuth 2.0 — протокол авторизации (что пользователь разрешает приложению). OIDC добавляет: ID Token (JWT) — содержит информацию о пользователе (sub, email, name); UserInfo endpoint — API для получения данных профиля; стандартные scopes (openid, profile, email). Применение: «Войти через Google/Facebook» — OIDC поток. Приложение получает access_token (для API) и id_token (для идентификации пользователя). Claims в id_token стандартизированы, что упрощает интеграцию.',
  },
  {
    id: 'sa-security-044',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Какие compliance-фреймворки и регуляторные требования должен учитывать системный аналитик при проектировании системы, обрабатывающей персональные данные в России и ЕС?',
    sampleAnswer:
      'Ключевые compliance-требования: (1) GDPR (ЕС): права субъектов данных (доступ, удаление, портируемость, согласие), Privacy by Design, DPIA (Data Protection Impact Assessment), уведомление об утечке в 72 часа, назначение DPO, legal basis для обработки, трансграничная передача (SCCs, Adequacy Decisions). (2) 152-ФЗ (Россия): согласие на обработку ПДн, локализация данных граждан РФ на территории РФ, уведомление Роскомнадзора, классификация ИСПДн по уровням защищённости, применение сертифицированных средств защиты, разработка модели угроз. (3) Общие требования: реестр обработок данных, минимизация данных, ограничение сроков хранения, encryption at rest и in transit, access control, audit logging. Архитектурные решения: геолокация данных (РФ-данные в РФ-дата-центрах), consent management system, механизмы реализации прав субъекта (API для экспорта/удаления данных), data classification и tagging, retention policies, data masking для непроизводственных сред.',
    explanation:
      'Compliance — не только юридический, но и технический вопрос. Аналитик должен трансформировать регуляторные требования в функциональные и нефункциональные требования к системе. Раннее вовлечение юристов и DPO критично. Несоответствие GDPR — штрафы до 4% годового оборота; 152-ФЗ — штрафы и блокировка сайта.',
  },
  {
    id: 'sa-security-045',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'junior',
    type: 'quiz',
    question: 'Что такое фишинг (Phishing)?',
    options: [
      'Атака на переполнение буфера',
      'Мошенничество, при котором злоумышленник выдаёт себя за доверенную организацию для получения конфиденциальных данных',
      'Сетевая атака на отказ в обслуживании',
      'Внедрение вредоносного кода в программу',
    ],
    correctIndex: 1,
    explanation:
      'Фишинг (Phishing) — вид социальной инженерии, при котором злоумышленник выдаёт себя за легитимную организацию (банк, соцсеть, госорган) через поддельные email, сайты, SMS для получения конфиденциальных данных: паролей, номеров карт, персональных данных. Виды: email phishing, spear phishing (целевой), whaling (на руководство), smishing (SMS), vishing (голосовые звонки). Защита: обучение пользователей, email filtering, DMARC/SPF/DKIM, MFA (защищает даже при утечке пароля), проверка URL.',
  },
  {
    id: 'sa-security-046',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Что такое SAML и для чего используется?',
    options: [
      'Язык программирования',
      'XML-стандарт для обмена данными аутентификации и авторизации между Identity Provider и Service Provider (SSO)',
      'Протокол шифрования',
      'База данных пользователей',
    ],
    correctIndex: 1,
    explanation:
      'SAML (Security Assertion Markup Language) — XML-стандарт для обмена данными аутентификации и авторизации. Используется для Single Sign-On (SSO) в корпоративной среде. Участники: Identity Provider (IdP) — аутентифицирует пользователя (Active Directory, Okta); Service Provider (SP) — приложение, доверяющее IdP. Процесс: пользователь обращается к SP → SP перенаправляет на IdP → IdP аутентифицирует и возвращает SAML Assertion (подписанный XML с данными пользователя) → SP проверяет подпись и предоставляет доступ. SAML широко распространён в enterprise; для современных веб-приложений чаще используется OpenID Connect.',
  },
  {
    id: 'sa-security-047',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Что такое Security by Design?',
    options: [
      'Фреймворк для визуального дизайна интерфейсов',
      'Принцип встраивания мер безопасности в архитектуру системы с самого начала проектирования',
      'Инструмент тестирования безопасности',
      'Стандарт документирования систем',
    ],
    correctIndex: 1,
    explanation:
      'Security by Design (Privacy by Design для персональных данных) — принцип, согласно которому безопасность не добавляется постфактум, а закладывается в архитектуру системы с начала проектирования. Включает: threat modeling на этапе дизайна, secure architecture patterns, минимизация attack surface, defence in depth, least privilege, secure defaults, fail secure. Противоположность — «болтовая» безопасность (bolt-on security), когда меры добавляются после разработки. Security by Design требуется GDPR (Privacy by Design), PCI DSS и другими стандартами.',
  },
  {
    id: 'sa-security-048',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'open',
    question: 'Вы проектируете систему, которая будет обрабатывать данные платёжных карт. Какие требования PCI DSS должны быть учтены в архитектуре?',
    sampleAnswer:
      'Ключевые архитектурные требования PCI DSS: (1) Сегментация сети: CDE (Cardholder Data Environment) изолирован от остальной сети файрволами; минимизация scope PCI DSS. (2) Защита хранимых данных: PAN (номер карты) шифруется при хранении (AES-256); CVV/CVC никогда не хранится; токенизация — замена PAN на токен для снижения scope. (3) Защита при передаче: TLS 1.2+ для всех передач данных карт; запрет передачи PAN по незащищённым каналам. (4) Контроль доступа: доступ к данным карт по принципу need-to-know; уникальные ID для всех пользователей; MFA для удалённого доступа. (5) Логирование и мониторинг: логирование всех обращений к данным карт; SIEM для обнаружения аномалий; хранение логов минимум год. (6) Регулярное тестирование: penetration testing (внутренний и внешний), vulnerability scanning, code review. (7) Безопасная разработка: secure SDLC, обучение разработчиков, защита от OWASP Top 10. (8) Управление поставщиками: все третьи стороны с доступом к данным карт должны быть PCI DSS compliant. Рекомендация: использовать сертифицированный payment gateway для приёма платежей, чтобы PAN никогда не попадал на ваши серверы (scope reduction).',
    explanation:
      'PCI DSS — детальный стандарт с 12 требованиями и ~300 контролями. Несоответствие грозит штрафами и потерей права принимать карты. Главная стратегия — minimizing scope: использовать tokenization и hosted payment pages, чтобы данные карт не касались вашей инфраструктуры. Аналитик должен работать с QSA (Qualified Security Assessor) для определения scope и требований.',
  },
  {
    id: 'sa-security-049',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'middle',
    type: 'quiz',
    question: 'Какой атрибут cookie предотвращает отправку cookie с cross-site запросами?',
    options: [
      'HttpOnly',
      'Secure',
      'SameSite',
      'Path',
    ],
    correctIndex: 2,
    explanation:
      'SameSite — атрибут cookie, контролирующий, отправляется ли cookie с cross-site запросами. Значения: Strict — cookie отправляется только при запросах с того же сайта (максимальная защита от CSRF, но может ломать легитимные сценарии); Lax (default в современных браузерах) — отправляется при top-level navigation GET-запросах; None — отправляется всегда (требует Secure). HttpOnly — запрещает доступ к cookie из JavaScript (защита от XSS). Secure — cookie отправляется только по HTTPS.',
  },
  {
    id: 'sa-security-050',
    block: 'sa',
    topic: 'security',
    topicLabel: 'Безопасность',
    difficulty: 'senior',
    type: 'quiz',
    question: 'Что такое ABAC (Attribute-Based Access Control)?',
    options: [
      'Контроль доступа на основе ролей',
      'Контроль доступа на основе атрибутов субъекта, ресурса, действия и окружения',
      'Контроль доступа на основе списков',
      'Контроль доступа на основе меток безопасности',
    ],
    correctIndex: 1,
    explanation:
      'ABAC (Attribute-Based Access Control) — модель контроля доступа, где решения принимаются на основе атрибутов: субъекта (роль, отдел, clearance level), ресурса (тип, владелец, classification), действия (read, write, delete), окружения (время, IP, устройство). Политики выражаются как правила: «Если субъект.отдел = ресурс.отдел И субъект.clearance >= ресурс.classification, то РАЗРЕШИТЬ». Преимущества перед RBAC: большая гибкость, динамические политики, меньше ролей («role explosion»). Стандарт: XACML. Применение: сложные enterprise-среды, fine-grained access control, cloud IAM (AWS IAM policies — форма ABAC).',
  },
];
